<head>
    <link rel="stylesheet" href="/css/leaflet.css" >
    <link rel="stylesheet" href="/css/fontello.css" >
    <link rel="stylesheet" href="/css/go-leaflet.css" >
    <script src="/js/leaflet.js"></script>
</head>
<body>
    <h1>{{.title}}</h1>
    <a href="/markers">Markers</a>
    <div id="mapid"></div>
</body>    
<script type="text/javascript">

  // Function to use X,Y coordinates instead of Y,X
  var yx = L.latLng;
  var xy = function(x, y) {
      if (L.Util.isArray(x)) {    // When doing xy([x, y]);
          return yx(-x[1], x[0]);
      }
      return yx(-y, x);  // -y because it's up to down and no down to up like by default
  };


  // Custom icon DIV CSS
  var myIconDIV = L.divIcon({className: 'icon-location blue'});





  // Map initializer
  var map = L.map('mapid', {
    crs: L.CRS.Simple,
    minZoom: -4,
    wheelPxPerZoomLevel: 125
  });
  var bounds = [xy(0,16410), xy(16410,0)] //bottom left, upper right
  var image = L.imageOverlay('/images/map_tree_of_life.jpg', bounds).addTo(map);
  map.fitBounds(bounds);
  {{ range $key, $m := call .markers }}
    var marker = L.marker(xy([{{$m.X}}, {{$m.Y}}])).addTo(map).bindPopup('<strong>{{ $m.Title }}</strong><br>{{ $m.Desc }}');
  {{ end }}
  

  // Custom markers for test
  var marker = L.marker(xy(3361,8872), {icon: myIconDIV}).addTo(map).bindPopup('Campement LCH');

  //var marker = L.marker(xy(3361,8872)).addTo(map).bindPopup('Campement LCH');
  var marker = L.marker(xy(5225,6084)).addTo(map).bindPopup('Campement Union');
  var marker = L.marker(xy(5250,12760)).addTo(map).bindPopup('Campement Catalunya');

</script>